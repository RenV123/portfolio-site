function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?right[Symbol.hasInstance](left):left instanceof right}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){var el=this;do{if(el.matches(s))return el;el=el.parentElement||el.parentNode}while(null!==el&&1===el.nodeType);return null}),function(root,factory){var plugin="Pageable";"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=factory(plugin):"function"==typeof define&&define.amd?define([],factory):root[plugin]=factory(plugin)}("undefined"!=typeof global?global:this.window||this.global,(function(){"use strict";var noop=function noop(){},getDataAttr=function(el,prop){return el.dataset?el.dataset[prop]:el.getAttribute("data-"+prop)},isObject=function isObject(val){return"[object Object]"===Object.prototype.toString.call(val)},extend=function extend(src,props){for(var prop in props)if(props.hasOwnProperty(prop)){var val=props[prop];val&&isObject(val)?(src[prop]=src[prop]||{},extend(src[prop],val)):src[prop]=val}return src},throttle=function throttle(fn,limit,context){var wait;return function(){if(context=context||this,!wait)return fn.apply(context,arguments),wait=!0,setTimeout((function(){wait=!1}),limit)}},SlideShow=function SlideShow(instance){this.instance=instance,this.running=!1,this.config=this.instance.config.slideshow};SlideShow.prototype.start=function(){var that=this;that.running||(that.running=!0,that.instance.slideIndex=that.instance.index,that.instance.interval=setInterval((function(){that.instance.config.onBeforeStart.call(that.instance,that.instance.slideIndex),setTimeout((function(){that.instance.config.infinite&&that.instance._overScroll(!0),that.instance.index<that.instance.pages.length-1?that.instance.slideIndex++:that.instance.slideIndex=0,that.instance.scrollToIndex(that.instance.slideIndex)}),that.config.delay||0)}),that.config.interval))},SlideShow.prototype.stop=function(){this.running&&(clearInterval(this.instance.interval),this.instance.slideInterval=!1,this.running=!1)};var Pageable=function Pageable(container,options){if(void 0===container)return console.error("Pageable:","No container defined.");var that=this,defaults={pips:!0,animation:300,delay:0,throttle:50,orientation:"vertical",easing:function easing(t,b,c,d,s){return-c*(t/=d)*(t-2)+b},onInit:noop,onUpdate:noop,onBeforeStart:noop,onStart:noop,onScroll:noop,onFinish:noop,swipeThreshold:50,freeScroll:!1,slideshow:!1,infinite:!1,childSelector:"[data-anchor]",events:{wheel:!0,mouse:!0,touch:!0,keydown:!0}};return this.container="string"==typeof container?document.querySelector(container):container,this.container?(this.config=extend(defaults,options),this.events=this.config.events,this.pages=[].slice.call(this.container.querySelectorAll(this.config.childSelector)),this.pages.length?(this.horizontal="horizontal"===this.config.orientation,this.anchors=[],this.pages.forEach((function(page,i){var clean="",anchor=getDataAttr(page,"anchor");clean=anchor?anchor.replace(/\s+/,"-").toLowerCase():Array.isArray(that.config.anchors)&&that.config.anchors.length?that.config.anchors[i].replace(/\s+/,"-").toLowerCase():page.className.replace(/\s+/,"-").toLowerCase(),page.id!==clean&&(page.id=clean),that.anchors.push("#"+clean),page.classList.add("pg-page"),0==i?page.classList.add("pg-active"):page.classList.remove("pg-active")})),this.axis=this.horizontal?"x":"y",this.mouseAxis={x:"clientX",y:"clientY"},this.scrollAxis={x:"scrollLeft",y:"scrollTop"},this.size={x:"width",y:"height"},this.bar=this._getScrollBarWidth(),this.index=0,this.slideIndex=0,this.oldIndex=0,this.down=!1,this.initialised=!1,this.touch="ontouchstart"in window||window.DocumentTouch&&_instanceof(document,DocumentTouch),void this.init()):console.error("Pageable:","No child nodes matching the selector "+this.config.childSelector+" could be found.")):console.error("Pageable:","The container could not be found.")};return Pageable.prototype.init=function(){if(!this.initialised&&!this.container.pageable){var o=this.config;if(this.wrapper=document.createElement("div"),this.container.parentNode.insertBefore(this.wrapper,this.container),this.wrapper.appendChild(this.container),this.wrapper.classList.add("pg-wrapper"),this.wrapper.classList.add("pg-"+o.orientation),this.wrapper.classList.add("pg-wrapper"),this.container.classList.add("pg-container"),document.body.style.margin=0,document.body.style.overflow="hidden",this.container.style.display="inline-block",["Prev","Next"].forEach((function(dir){var str="nav"+dir+"El";o[str]&&("string"==typeof o[str]?this[str]=document.querySelector(o[str]):_instanceof(o[str],Element)&&(this[str]=o[str]),this[str]&&this[str].classList.add("pg-nav"))}),this),o.pips){var nav=document.createElement("nav"),ul=document.createElement("ul");nav.classList.add("pg-pips"),this.pages.forEach((function(page,index){var li=document.createElement("li"),a=document.createElement("a"),span=document.createElement("span");a.href="#"+page.id,0==index&&a.classList.add("active"),a.appendChild(span),li.appendChild(a),ul.appendChild(li)})),nav.appendChild(ul),this.wrapper.appendChild(nav),this.pips=[].slice.call(ul.children)}this.pageCount=this.pages.length,this.lastIndex=this.pageCount-1,o.infinite&&this._toggleInfinite(!1,!0),this.bind(),this.update(),this._load();var data=this._getData();this.config.onInit.call(this,data),this.emit("init",data),this.initialised=!0,this.container.pageable=this,o.slideshow&&(this.slider=new SlideShow(this),this.slider.start())}},Pageable.prototype.bind=function(){this.callbacks={wheel:this._wheel.bind(this),update:throttle(this.update.bind(this),this.config.throttle),load:this._load.bind(this),start:this._start.bind(this),drag:this._drag.bind(this),stop:this._stop.bind(this),click:this._click.bind(this),prev:this.prev.bind(this),next:this.next.bind(this),keydown:this._keydown.bind(this),hashChanged:this._locationHashChanged.bind(this)},document.addEventListener("keydown",this.callbacks.keydown,!1),this.wrapper.addEventListener("wheel",this.callbacks.wheel,!1),window.addEventListener("resize",this.callbacks.update,!1),this.wrapper.addEventListener(this.touch?"touchstart":"mousedown",this.callbacks.start,!1),window.addEventListener(this.touch?"touchmove":"mousemove",this.callbacks.drag,{passive:!1}),window.addEventListener(this.touch?"touchend":"mouseup",this.callbacks.stop,!1),window.addEventListener("hashchange",this.callbacks.hashChanged,!1),this.navPrevEl&&(this.navPrevEl.addEventListener("click",this.callbacks.prev,!1),this.navNextEl&&this.navNextEl.addEventListener("click",this.callbacks.next,!1)),document.addEventListener("click",this.callbacks.click,!1)},Pageable.prototype.unbind=function(){this.wrapper.removeEventListener("wheel",this.callbacks.wheel),window.removeEventListener("resize",this.callbacks.update),this.wrapper.removeEventListener(this.touch?"touchstart":"mousedown",this.callbacks.start),window.addEventListener(this.touch?"touchmove":"mousemove",this.callbacks.drag),window.removeEventListener(this.touch?"touchend":"mouseup",this.callbacks.stop),window.removeEventListener("hashchange",this.callbacks.hashChanged),document.removeEventListener("keydown",this.callbacks.keydown),this.navPrevEl&&this.navPrevEl.removeEventListener("click",this.callbacks.prev,!1),this.navNextEl&&this.navNextEl.removeEventListener("click",this.callbacks.next,!1),document.removeEventListener("click",this.callbacks.click)},Pageable.prototype.scrollToPage=function(page){this.scrollToIndex(page-1)},Pageable.prototype.scrollToAnchor=function(id){this.scrollToIndex(this.anchors.indexOf(id))},Pageable.prototype.scrollToIndex=function(index){if(!this.scrolling&&index>=0&&index<=this.pages.length-1){var oldIndex=this.index;this.index=index,this.oldIndex=oldIndex,this._scrollBy(this._getScrollAmount(oldIndex))}},Pageable.prototype.next=function(){if(this.config.infinite){var index=this.index;if(index===this.lastIndex)return index++,this._scrollBy(-this.data.window[this.size[this.axis]],index)}this.scrollToIndex(this.index+1)},Pageable.prototype.prev=function(){if(this.config.infinite){var index=this.index;if(0===index)return index--,this._scrollBy(this.data.window[this.size[this.axis]],index)}this.scrollToIndex(this.index-1)},Pageable.prototype.update=function(){clearTimeout(this.timer),this.data={window:{width:window.innerWidth,height:window.innerHeight},container:{height:this.wrapper.scrollHeight,width:this.wrapper.scrollWidth}};var size=this.size[this.axis],opp=this.horizontal?this.size.y:this.size.x;this.wrapper.style["overflow-"+this.axis]="scroll",this.wrapper.style[size]=this.data.window[size]+"px",this.wrapper.style[opp]=this.data.window[opp]+this.bar+"px";var len=this.config.infinite?this.pages.length+2:this.pages.length,offset=this.config.infinite?this.data.window[size]:0;this.container.style[size]=len*this.data.window[size]+"px",this.wrapper.style["padding-"+(this.horizontal?"bottom":"right")]=this.bar+"px",this.wrapper[this.scrollAxis[this.axis]]=this.index*this.data.window[size]+offset,this.scrollSize=len*this.data.window[size]-this.data.window[size],this.scrollPosition=this.data.window[size]*this.index+offset,this.pages.forEach((function(page,i){this.horizontal&&(page.style.float="left"),page.style[size]=this.data.window[size]+"px",page.style[opp]=this.data.window[opp]+"px"}),this),this.config.infinite&&this.clones.forEach((function(clone){this.horizontal&&(clone.style.float="left"),clone.style[size]=this.data.window[size]+"px",clone.style[opp]=this.data.window[opp]+"px"}),this),this.config.onUpdate.call(this,this._getData()),this.emit("update",this._getData())},Pageable.prototype.orientate=function(type){switch(type){case"vertical":this.horizontal=!1,this.axis="y",this.container.style.width="";break;case"horizontal":this.horizontal=!0,this.axis="x",this.container.style.height="";break;default:return!1}this.horizontal?(this.wrapper.classList.add("pg-horizontal"),this.wrapper.classList.remove("pg-vertical")):(this.wrapper.classList.add("pg-vertical"),this.wrapper.classList.remove("pg-horizontal")),this.config.orientation=type,this.update()},Pageable.prototype.slideshow=function(){return this.slider},Pageable.prototype.destroy=function(){if(this.initialised){this.emit("destroy"),this.unbind(),document.body.style.margin="",document.body.style.overflow="",this.container.style.display="",this.container.style.height="",this.container.style.width="",this.container.classList.remove("pg-container"),this.wrapper.parentNode.replaceChild(this.container,this.wrapper);for(var i=0;i<this.pages.length;i++){var page=this.pages[i];page.style.height="",page.style.width="",page.style.float="",page.classList.remove("pg-page"),page.classList.remove("pg-active")}["Prev","Next"].forEach((function(dir){var str="nav"+dir+"El";this[str]&&(this[str].classList.remove("active"),this[str].classList.remove("pg-nav"))}),this),this.config.infinite&&this._toggleInfinite(!0),this.config.slideshow&&(this.slider.stop(),this.slider=!1),this.initialised=!1,delete this.container.pageable}},Pageable.prototype.on=function(listener,callback){this.listeners=this.listeners||{},this.listeners[listener]=this.listeners[listener]||[],this.listeners[listener].push(callback)},Pageable.prototype.off=function(listener,callback){this.listeners=this.listeners||{},listener in this.listeners!=!1&&this.listeners[listener].splice(this.listeners[listener].indexOf(callback),1)},Pageable.prototype.emit=function(listener){if(this.listeners=this.listeners||{},listener in this.listeners!=!1)for(var i=0;i<this.listeners[listener].length;i++)this.listeners[listener][i].apply(this,[].slice.call(arguments,1))},Pageable.prototype._click=function(e){if(e.target.closest){var anchor=e.target.closest("a");anchor&&this.anchors.indexOf(anchor.hash)>-1&&(e.preventDefault(),this.scrollToAnchor(anchor.hash))}},Pageable.prototype._preventDefault=function(e){e.preventDefault(),e.stopPropagation()},Pageable.prototype._keydown=function(e){if(this.config.events.keydown){if(this.scrolling||this.dragging)return e.preventDefault(),!1;var code=!1;void 0!==e.key?code=e.key:void 0!==e.keyCode&&(code=e.keyCode);var dir1="Arrow"+("x"===this.axis?"Left":"Up"),dir2="Arrow"+("x"===this.axis?"Right":"Down");if(code)switch(code){case 33:case 37:case dir1:case"PageUp":e.preventDefault(),this.prev();break;case 34:case 39:case dir2:case"PageDown":e.preventDefault(),this.next()}}},Pageable.prototype._start=function(e){var evt=this._getEvent(e);return!this.scrolling&&!this.dragging&&("touchstart"!==e.type||this.events.touch?!!("mousedown"!==e.type||this.events.mouse&&0===e.button)&&(!!evt.target.closest(this.config.childSelector)&&(this.dragging=this.config.freeScroll,this.config.slideshow&&this.slider.stop(),this.down={x:evt.clientX,y:evt.clientY},this.startIndex=this.index,void this.config.onBeforeStart.call(this,this.index))):(evt.target.closest("a")||this._preventDefault(e),!1))},Pageable.prototype._drag=function(e){if(e.preventDefault(),this.config.freeScroll&&this.dragging&&!this.scrolling){var evt=this._getEvent(e),scrolled=this._limitDrag(evt),data=this._getData();this.container.style.transform=this.horizontal?"translate3d("+scrolled+"px, 0, 0)":"translate3d(0, "+scrolled+"px, 0)",data.scrolled-=scrolled,this.config.onScroll.call(this,data,"drag"),this.emit("scroll",data)}},Pageable.prototype._stop=function(e){var that=this,evt=this._getEvent(e),inc=function inc(){that.index<that.pages.length-1&&that.index++},dec=function dec(){0<that.index&&that.index--};this.oldIndex=this.index;var diff=Math.abs(evt[this.mouseAxis[this.axis]]-this.down[this.axis])>=this.config.swipeThreshold,canChange=this.down&&diff;if(this.config.slideshow&&this.slider.start(),this.dragging&&!this.scrolling){var scrolled=this._limitDrag(evt);return this.dragging=scrolled,canChange&&(this.config.infinite&&this._overScroll(scrolled<0,scrolled),scrolled>0?dec():inc()),this._scrollBy(this._getScrollAmount(this.oldIndex)-scrolled),void(this.down=!1)}if(this.down&&!this.scrolling){var pos=evt[this.mouseAxis[this.axis]]<this.down[this.axis],neg=evt[this.mouseAxis[this.axis]]>this.down[this.axis];canChange&&(this.config.infinite&&this._overScroll(pos),pos?inc():neg&&dec()),this.startIndex===this.index?this.config.onFinish.call(this,this._getData()):this._scrollBy(this._getScrollAmount(this.oldIndex)),this.down=!1}},Pageable.prototype._wheel=function(e){if(e.preventDefault(),this.events.wheel&&!this.scrolling){var index=this.index,oldIndex=this.index,inc=0<e.deltaY;this.config.infinite&&this._overScroll(inc),inc?this.index<this.pages.length-1&&index++:0<this.index&&index--,index!==oldIndex&&(this.oldIndex=oldIndex,this.scrollToIndex(index))}},Pageable.prototype._load=function(e){var id=location.hash;if(id){var index=this.anchors.indexOf(id);if(index>-1){var offset=this.config.infinite?1:0;this.scrollPosition=this.data.window[this.size[this.axis]]*(index+offset);var data=this._getData();this.index=index,this.slideIndex=index,this.pages.forEach((function(page,i){i===this.index?page.classList.add("pg-active"):page.classList.remove("pg-active")}),this),this._setNavs(),this._setPips(),this.config.onScroll.call(this,data),this.config.onFinish.call(this,data),this.emit("scroll",data)}}this.update()},Pageable.prototype._getEvent=function(e){return this.touch?"touchend"===e.type?e.changedTouches[0]:e.touches[0]:e},Pageable.prototype._getData=function(){var scrolled=this.config.infinite?this.scrollPosition-this.data.window[this.size[this.axis]]:this.scrollPosition,max=this.config.infinite?this.scrollSize-2*this.data.window[this.size[this.axis]]:this.scrollSize;return{index:this.index,percent:scrolled/max*100,scrolled:scrolled,max:max}},Pageable.prototype._overScroll=function(inc){var scrolled=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,index=this.index;index===this.lastIndex&&inc?(index++,this._scrollBy(-this.data.window[this.size[this.axis]]-scrolled,index)):0!==index||inc||(index--,this._scrollBy(this.data.window[this.size[this.axis]]-scrolled,index))},Pageable.prototype._scrollBy=function(amount,index){if(this.scrolling)return!1;this.scrolling=!0,this.config.onBeforeStart.call(this,this.oldIndex),this.emit("scroll.before",this._getData()),this.config.slideshow&&this.slider.stop();var that=this;that.timer=setTimeout((function(){var st=Date.now(),offset=that._getScrollOffset(),scroll=function scroll(){var now,ct=Date.now()-st;if(ct>that.config.animation){cancelAnimationFrame(that.frame),that.container.style.transform="",that.frame=!1,that.scrolling=!1,that.dragging=!1,that.config.slideshow&&that.slider.start(),that.config.infinite&&(index===that.pageCount?that.index=0:-1===index&&(that.index=that.lastIndex));var data=that._getData();return window.location.hash=that.pages[that.index].id,that.pages.forEach((function(page,i){i===that.index?page.classList.add("pg-active"):page.classList.remove("pg-active")}),that),that.slideIndex=that.index,that._setPips(),that._setNavs(),that.config.onFinish.call(that,data),that.emit("scroll.end",data),!1}var start=that.dragging?that.dragging:0,scrolled=that.config.easing(ct,start,amount,that.config.animation);that.container.style.transform=that.horizontal?"translate3d("+scrolled+"px, 0, 0)":"translate3d(0, "+scrolled+"px, 0)",that.scrollPosition=offset[that.axis]-scrolled;var data=that._getData();that.config.infinite&&(index===that.pageCount?data.scrolled=0:-1===index&&(data.scrolled=data.max)),that.config.onScroll.call(that,data),that.emit("scroll",data),that.frame=requestAnimationFrame(scroll)};that.config.onStart.call(that,that.pages[that.index].id),that.emit("scroll.start",that._getData()),that.frame=requestAnimationFrame(scroll)}),that.dragging?0:that.config.delay)},Pageable.prototype._getScrollOffset=function(){return{x:this.wrapper.scrollLeft,y:this.wrapper.scrollTop}},Pageable.prototype._getScrollAmount=function(oldIndex,newIndex){void 0===newIndex&&(newIndex=this.index);var h=this.data.window[this.size[this.axis]],a,b;return h*oldIndex-h*newIndex},Pageable.prototype._getScrollBarWidth=function(){var db=document.body,div=document.createElement("div"),t=0;return div.style.cssText="width: 100; height: 100; overflow: scroll; position: absolute; top: -9999;",db.appendChild(div),t=div.offsetWidth-div.clientWidth,db.removeChild(div),t},Pageable.prototype._toggleInfinite=function(destroy,force){if(destroy&&this.config.infinite)this.clones.forEach((function(clone){this.container.removeChild(clone)}),this),this.config.infinite=!1;else if(!this.config.infinite||force){this.config.infinite=!0;var first=this.pages[0].cloneNode(!0),last=this.pages[this.lastIndex].cloneNode(!0);first.id=first.id+"-clone",last.id=last.id+"-clone",first.classList.add("pg-clone"),last.classList.add("pg-clone"),first.classList.remove("pg-active"),last.classList.remove("pg-active"),this.clones=[first,last],this.container.insertBefore(last,this.pages[0]),this.container.appendChild(first)}this.update()},Pageable.prototype._limitDrag=function(e){var scrolled=e[this.mouseAxis[this.axis]]-this.down[this.axis];return this.config.infinite||(0===this.index&&scrolled>0||this.index===this.pages.length-1&&scrolled<0)&&(scrolled/=10),scrolled},Pageable.prototype._setNavs=function(){this.navPrevEl&&(this.config.infinite||this.index>0?this.navPrevEl.classList.add("active"):this.navPrevEl.classList.remove("active")),this.navNextEl&&(this.config.infinite||this.index<this.pages.length-1?this.navNextEl.classList.add("active"):this.navNextEl.classList.remove("active"))},Pageable.prototype._setPips=function(index){this.config.pips&&(void 0===index&&(index=this.index),this.pips.forEach((function(pip,i){i==index?pip.firstElementChild.classList.add("active"):pip.firstElementChild.classList.remove("active")})))},Pageable.prototype._locationHashChanged=function(){if(this.config.pips){var id=location.hash;id&&(this.index=this.anchors.indexOf(id),this._setPips(this.index))}},Pageable}));